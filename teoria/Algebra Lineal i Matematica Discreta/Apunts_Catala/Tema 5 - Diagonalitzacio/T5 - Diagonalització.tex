\documentclass{beamer}
\usepackage[spanish]{babel}
\usepackage[latin1]{inputenc}
\usepackage{multicol} % indice en 2 columnas
\usepackage{centernot}
\usepackage{amsmath}% http://ctan.org/pkg/amsmath

\usepackage{color}


\usepackage{graphicx}
\graphicspath{ {im/} }


\newcommand{\notimplies}{%
  \mathrel{{\ooalign{\hidewidth$\not\phantom{=}$\hidewidth\cr$\implies$}}}}


\usetheme{Warsaw}
%\usecolortheme{crane}
\useoutertheme{shadow}
\useinnertheme{rectangles}

\setbeamertemplate{navigation symbols}{} % quitar simbolitos



\title[Tema 5 - Diagonalització d'Endomorfismes]{Diagonalització d'Endomorfismes}
\subtitle{Grau en Enginyeria Telemàtica}
\author[Juan Gabriel Gomila]{
Juan Gabriel Gomila%$^{1}$  \and E. Eva$^{2}$ \and S. Serpiente$^{3}$
}
\institute[UIB]{
 % $^{1-2}$
 Grau en Enginyeria Telemàtica
 \and
  Universitat de les Illes Balears
  \and
  \texttt{juangabriel.gomila@uib.es}
}
\date{\today}

\AtBeginSection{
\begin{frame}
  \begin{multicols}{2}
  \tableofcontents[currentsection]   
\end{multicols}
\end{frame}
}

\AtBeginSubsection{
\begin{frame}
  \begin{multicols}{2}
  \tableofcontents[currentsection,currentsubsection]
\end{multicols}
\end{frame}
}



%empieza aqui


\begin{document} 

\frame{\titlepage}

\begin{frame}
  \frametitle{Índex}
  \tableofcontents
\end{frame}

\section{Introducció}

\begin{frame}
\frametitle{Introducció}
Abans d'entrar matemàticament en el tema de diagonalització de matrius quadrades, exposarem alguna de les aplicacions que té l'ús de les matrius diagonals. 


Recordem que una matriu diagonal és una matriu quadrada que té zeros en tots els elements fora de la seva diagonal principal.
\end{frame}

\begin{frame}
\frametitle{Introducció}
La factorització d'una matriu donada $A$ en funció d'una altra matriu diagonal $D$ permet resoldre problemes d'anàlisi i estudi dels sistemes elèctrics, vibracions, economia, etc... que solen venir modelitzats per equacions diferencials i en derivades parcials. 


En aquesta factorització hi juguen un paper molt important  uns escalars anomenats \textbf{valors propis} i un tipus especials de vectors anomenats \textbf{vectors propis}
\end{frame}

\begin{frame}
\frametitle{Introducció}
Un tipus d'aplicació de la diagonalització de matrius es troba en l'anàlisi de la solució d'un sistema dinàmic al llarg del temps. 

Un sistema es caracteritza per l'estat d'un conjunt de $n$ variables que el determinen. Aquest conjunt es pot expressar com un vector de $\mathbb R^n$ les components del qual expressen els valors d'aquestes variables
\[(x_1,x_2,\cdots, x_n)\]
Si l'estat evoluciona al llarg del temps modificant el seu valor a cada periode (cada hora, dia, mes,...) es molt comú que la relació entre els estats del sistema es presenti de forma recursiva:
\end{frame}
 
 
 
\begin{frame}
\frametitle{Introducció}
\begin{itemize}
\item $X_{p+1} = A\cdot X_p$, on $A$ és una matriu quadrada d'ordre $n$
\item$X_p$ representa l'estat del sistema en el periode $p$
\item $X_{p+1}$ representa l'estat del sistema en el periode següent $p+1$
\end{itemize}
Llavors, basta coneixer l'estat del sistema en el periode inicial $X_0$ (estat inicial del sistema) per poder calcular l'estat del sistema en qualsevol periode.

\end{frame}

\begin{frame}
\frametitle{Introducció}
En efecte, si coneixem l'estat inicial $X_0$, podem coneixer
\[X_1 = A\cdot X_0\]
\[X_2 = A\cdot X_1 = A\cdot (A\cdot X_0) = A^2\cdot X_0\]
\[\cdots\]
\[X_m = A^m \cdot X_0\]

Per tant, per coneixer l'estat del sistema en el periode $m$ és necessari el càlcul de la matriu $A^m$. Aquest càlcul, ja imaginareu que és bastant complicat i és difícil no equivocar-se... En canvi, se simplifica bastant en el cas de que $A$ sigui diagonalitzable (com recordareu del Tema 1 de Matrius). 
\end{frame}

\section{Diagonalització}

\begin{frame}
\frametitle{Matrius semblants}
\begin{block}{Matrius Semblants}
Dues matrius $A$ i $A'$ són \textbf{semblants} si existeix una matriu $P$ quadrada invertible (amb $|P|\neq 0$) tal que $A' = P^{-1}\cdot A\cdot P$
\end{block}
\end{frame}

\begin{frame}
\frametitle{Matrius semblants}
Pensem que totes les matrius semblats constitueixes les diverses representacions analítiques d'un mateix endomorfisme $f$ d'un espai vectorial $E$ de dimensió $n$ en diferents bases de $E$.
\begin{figure}[h]
\label{diagonalitzacio}
\centering
\includegraphics[height=3cm]{diagonalitzacio}
\end{figure}
\end{frame}

\begin{frame}
\frametitle{Matrius semblants}
Això planteja el problema de cerca la base de $E$ en la qual $f$ es presenti de la forma més senzilla possible. Degut a les caracteristiques tan bones que presenten les matrius diagonals, s'intenta trobar una base de $E$ en la qual $f$ estigui representada per una matriu diagonal, és a dir, donada una matriu $A$ en una base qualssevol, volem cercar una matriu diagonal semblant a ella. 

Aquest procès rebrà el nom de \textbf{diagonalitzar la matriu o l'endomorfisme}. 
\end{frame}


\begin{frame}
\frametitle{Matrius diagonalitzables}
\begin{block}{Matriu Diagonalitzable}
Una matriu $A$ és diagonalitzable si és semblant a una matriu diagonal $D$, és a dir, si existeix una matriu $P$ regular tal que $D=P^{-1}\cdot A \cdot P$.

Això no és possible sempre. Haurem de veure en quines condicions existeix una matriu així i respecte de quina base representarà l'endomorfisme. 
\end{block}
\end{frame}


\section{Vectors i Valors propis d'una Matriu}

\subsection{Definicions}
\begin{frame}
\frametitle{Matrius diagonalitzables}
La teoria que veurem a continuació, està pensada per aconseguir arribar a diagonalitzar una matriu, però no hem d'olvidar que aquesta matriu, realment representa un cert endomorfisme en una certa base. 
\end{frame}

\begin{frame}
\frametitle{Vectors Propis }
\begin{block}{Vector Propi (o autovector)}
Donada una matriu quadrada $A\in M_{n\times n}$ de tamany $n$ els vectors columna del qual pertanyen a un espai vectorial $E$ de dimensió $n$, un element $\vec x \in E$ és un \textbf{vector propi} de $A$ si
\begin{enumerate}
\item $\vec x \neq \vec 0$ no és el vector nul
\item Existeix un escalar $\lambda \in \mathbb R$ tal que verifica $A\cdot \vec x = \lambda \vec x$
\end{enumerate}
\end{block}

Geomètricament, un vector propi $\vec x$ és aquell que té la mateixa direcció que el vector $A\cdot \vec x$ transformat per la matriu $A$. 
\end{frame}

\begin{frame}
\frametitle{Vectors Propis }
\begin{block}{Exercici 1}
Demostrar que $\vec x = (2,-1)$ és un vector propi de la matriu $B=\left(\begin{array}{rr}4 & 4 \\1 & 4\end{array}\right)$.
\end{block}
Resulta que $\vec x$ serà un vector propi de la matriu si es compleix que $B\cdot \vec x = \lambda \vec x$ per algun escalar $\lambda$.

\[\left(\begin{array}{rr}4 & 4 \\1 & 4\end{array}\right) \left(\begin{array}{r}2\\-1\end{array}\right) = \left(\begin{array}{r}4\\-2\end{array}\right)\]

i com que el vector $(4,-2)$ resulta ser $2(2,-1)$, és a dir $B\cdot \vec x = 2 \vec x$, aleshores $\vec x$ és un vector propi de $B$.

\end{frame}



\begin{frame}
\frametitle{Valor Propis }
\begin{block}{Valor Propi (o autovalor)}
L'escalar $\lambda$ de la definició anterior s'anomena valor propi associat al vector propi $\vec x$. El conjunt de tots els vectors que satisfan la relació $A\cdot \vec x = \lambda \vec x$ reben el nom de conjunt de vectors propis associats al valor propi $\lambda$.
\end{block}
\end{frame}



\subsection{Càlcul de vectors i valors propis}
\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
Partim de l'equació matricial anterior
\[A\cdot \vec x = \lambda \vec x\]
que també es pot expressar com
\[A\cdot \vec x - \lambda \vec x = \vec 0\]
o bé
\[(A - \lambda I)\cdot \vec x = \vec 0\]
Aquesta equació representa un sistema \textbf{homogeni} de $n$ equacions i $n$ incògnites, amb matriu de coeficients $A-\lambda I$
\end{frame}

\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
Si aquest sistema d'equacions és de Cramer ($n$ equacions, $n$ incògnites, de rang $n$ amb $|A-\lambda I |\neq 0$) serà compatible i determinat, i la seva única solució serà la solució trivial $\vec x = \vec 0$.

Si en canvi, si el sistema ha de tenir solucions diferents de la solució trivial, aleshores el determinant de $A-\lambda I$ haurà de ser zero:
\[|A-\lambda I| = 0\]
Es a dir, existiran vector propis de la matriu, únicament en el cas en que $|A-\lambda I | = 0$.
\end{frame}

\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
\begin{block}{Exercici 2}
Té vectors propis la matriu $A$?
\[\left(\begin{array}{rrr}4 & -1 & 6 \\2 & 1 & 6 \\2 & -1 & 8\end{array}\right)\]
\end{block}
\end{frame}

\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
Construim la matriu $A-\lambda I$
\[\left(\begin{array}{ccc}4-\lambda & -1 & 6 \\2 & 1 -\lambda& 6 \\2 & -1 & 8-\lambda\end{array}\right)\]
En calculam el determinant
\[|A-\lambda I | = (9-\lambda)(2-\lambda)^2\]
Per tant el determinant és nul pels valors de $\lambda \in \{2,9\}$. Aquests seran els dos valors propis de la matriu.
\begin{itemize}
\item Els vectors $\vec x$ que verifiquin $(A-2I)\cdot \vec x = \vec 0$ seran els vectors propis associats al valor propi $\lambda_1 = 2$.
\item Els vectors $\vec x$ que verifiquin $(A-9I)\cdot \vec x = \vec 0$ seran els vectors propis associats al valor propi $\lambda_2 = 9$.
\end{itemize}

\end{frame}


\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
En l'exercici que acabam de fer, hem vist que el resultat de desenvolupar el determinant $|A-\lambda I |$ és un polinomi en la variable $\lambda$.
\begin{block}{Polinomi característic d'una matriu $A$}
El \textbf{polinomi característic} d'una matriu $A$ és el polinomi de grau $n$ que surt en calcular el determinant $|A-\lambda I|$.
\end{block}
\begin{block}{Equació característica d'una matriu $A$}
L'equació característica d'una matriu $A$ és la que s'obté en igualar el seu polinomi característic a zero: $|A-\lambda I | = 0$.

Les $n$ solucions d'aquesta equació són els valors propis de la matriu. 
\end{block}
\end{frame}


\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
Com que l'equació característica és de grau $n$, té exactament $n$ solucions, no necessariament diferents entre elles. Per tant, es convenient acompanyar cada arrel del polinomi del nombre de vegades que aquesta es repeteix. 
\begin{block}{Multiplicitat algebraica d'un valor propi}
Donat un valor propi $\lambda_i$ d'una matriu característica $A-\lambda I$, s'anomena \textbf{multiplicitat algebraica} de $\lambda_i$ al nombre de vegades que apareix com a solució de l'equació característica.
\end{block}
En l'exercici anterior, el polinomi caracteristic era $(9- \lambda)(2-\lambda)^2$, per tant
\begin{itemize}
\item El valor propi $\lambda_1=2$ té multiplicitat algebraica 2
\item El valor propi $\lambda_2=9$ té multiplicitat algebraica 1
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
\begin{block}{Exercici 3}
Calculau els autovalors de la matriu
\[A=\left(\begin{array}{rrr}1 & 1 & 0 \\1 & -1 & -1 \\0 & 2 & 1\end{array}\right)\]
\end{block}
\end{frame}

\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
\[A-\lambda I=\left(\begin{array}{ccc}1-\lambda & 1 & 0 \\1 & -1-\lambda & -1 \\0 & 2 & 1-\lambda\end{array}\right)\]
\begin{itemize}
\item El polinomi característic és $\lambda^2 (1-\lambda)$.
\item L'equació característica és $\lambda^2(1-\lambda) = 0$.
\item Els valors propis són $\lambda_1=0$ amb multiplicitat algebraica 2, i $\lambda_2 = 1$ amb multiplicitat algebraica 1. 
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
Una vegada hem calculat tots els valors propis ens tocarà calcular el conjunt de vectors propis associats a cada valor propi. Per fer-ho resoldrem per a cada valor propi $\lambda_i$ el sistema homogeni següent:
\[(A - \lambda_i I) \cdot \vec x = \vec 0\]
\end{frame}

\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
\begin{block}{Exercici 4}
Calculau els vectors propis de la matriu
\[A=\left(\begin{array}{rrr}2 & -2 & 1 \\2 & -8 & -2 \\1 & 2 & 2\end{array}\right)\]
\end{block}
\end{frame}



\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
\[A-\lambda I=\left(\begin{array}{ccc}2-\lambda & -2 & 1 \\2 & -8-\lambda & -2 \\1 & 2 & 2-\lambda\end{array}\right)\]
Els valors propis són $\lambda_1=0,\lambda_2=3, \lambda_3 = -7$ amb multiplicitat algebraica 1 els tres.
\begin{itemize}
\item Els vectors propis $\vec x$ associats al valor propi $\lambda_1=0$ són els que compleixin $(A-0I)\cdot \vec x = \vec 0$.
\item Els vectors propis $\vec x$ associats al valor propi $\lambda_2=3$ són els que compleixin $(A-3I)\cdot \vec x = \vec 0$.
\item Els vectors propis $\vec x$ associats al valor propi $\lambda_3=-7$ són els que compleixin $(A+7I)\cdot \vec x = \vec 0$.
\end{itemize}
\end{frame}



\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
Per $\lambda_1=0$:
\[(A-0I)\cdot \vec x = \vec 0\]
té per solució la familia de vectors 
\[(-z,-z/2,z)\]
\end{frame}


\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
Per $\lambda_2=3$:
\[(A-2I)\cdot \vec x = \vec 0\]
té per solució la familia de vectors 
\[(z,0,z)\]
\end{frame}



\begin{frame}
\frametitle{Càlcul de valors i vectors propis}
Per $\lambda_3=-7$:
\[(A+7I)\cdot \vec x = \vec 0\]
té per solució la familia de vectors 
\[(-z,-4z,z)\]
\end{frame}



\subsection{Subespai propi associat a un valor propi}
\begin{frame}
\frametitle{Subespai propi associat a un valor propi}
Se pot demostrar que
\begin{itemize}
\item Si $\vec x, \vec x'$ són dos vectors propis qualssevol de la matriu $A$ associats al mateix valor propi $\lambda$, aleshores la seva suma $\vec x +\vec x'$ també és un vector propi de $A$ associat al mateix valor propi $\lambda$.
\item Si $\vec x$ és un vector propi de la matriu $A$ associat al valor propi $\lambda$, també ho és qualssevol altre vector de la forma $\mu \vec x$ on $\mu$ és un escalar no nul.
\end{itemize}
\end{frame}

\begin{frame}
\frametitle{Subespai propi associat a un valor propi}
Tenint en compte el teorema de caracterització de subespais (la suma de dos vectors del subconjunt pertany al subconjunt, i el producte d'un escalar per un vector del subconjunt és del subconjunt):
\begin{block}{Subespai propi associat a un valor propi}
El conjunt dels vectors propis associats al mateix valor propi $\lambda$ juntament amb el vector $\vec 0$, constitueixen un subespai vectorial de $E$ anomenat \textbf{subespai propi associat al valor propi} $\lambda$.
\end{block}

\begin{block}{Multiplicitat geomètrica d'un valor propi}
La multiplicitat geomètrica d'un valor propi $\lambda_i$ és la dimensió del seu subespai propi associat.
\end{block}

\end{frame}





\begin{frame}
\frametitle{Subespai propi associat a un valor propi}
\begin{block}{Exercici 5}
Donada la matriu 
\[A=\left(\begin{array}{rrr}4 & 1 & 1 \\1 & 4 & 1 \\1 & 1 & 4\end{array}\right)\]
trobau els autovalors, i els subespais propis associats a cadascun d'ells. 
\end{block}
\end{frame}

\begin{frame}
\frametitle{Subespai propi associat a un valor propi}

\[A-\lambda I=\left(\begin{array}{ccc}4-\lambda & 1 & 1 \\1 & 4-\lambda & 1 \\1 & 1 & 4-\lambda\end{array}\right)\]
El polinomi característic és $|A-\lambda I | = (3-\lambda)^2(6-\lambda)$, que té l'autovalor $\lambda_1=3$ amb multiplicitat algebraica 2, i l'autovalor $\lambda_2=6$ amb multiplicitat algebraica 1. 
\end{frame}

\begin{frame}
\frametitle{Subespai propi associat a un valor propi}
Els vectors propis $\vec x$ associats al valor propi $\lambda_1 = 3$ són els que compleixen $(A-3I)\vec x = \vec 0$
\[A-3 I=\left(\begin{array}{ccc}1 & 1 & 1 \\1 & 1 & 1 \\1 & 1 & 1\end{array}\right)\]
Aleshores, $(A-3I)\vec x = \vec 0$ ens dona la mateixa equació tres vegades, un SCI amb dos graus de llibertat:
\[x+y+z = 0\Rightarrow x = -y-z\]
El subespai propi associat a $\lambda_1=3$ serà:
\[H_1 = \langle (x,y,z) \rangle = \langle (-y-z,y,z) \rangle = \langle (-1,1,0), (-1,0,1) \rangle\]
Com que són dos vectors no proporcionals, són LI i per tant són una base de $H_1$, d'on $dim\ H_1 = 2$
\end{frame}

\begin{frame}
\frametitle{Subespai propi associat a un valor propi}
Els vectors propis $\vec x$ associats al valor propi $\lambda_1 = 6$ són els que compleixen $(A-6I)\vec x = \vec 0$
\[A-6 I=\left(\begin{array}{ccc}-2 & 1 & 1 \\1 & -2 & 1 \\1 & 1 & -2\end{array}\right)\]
Aleshores, $(A-6I)\vec x = \vec 0$ ens dona dues equacions diferents, un SCI amb un grau de llibertat::
\[x=y=z\]
El subespai propi associat a $\lambda_2=6$ serà:
\[H_2 = \langle (x,y,z) \rangle = \langle (x,x,x) \rangle = \langle (1,1,1) \rangle\]
Com que només tenim un vector no nul, és LI i per tant és una base de $H_2$, d'on $dim\ H_2 = 1$
\end{frame}

\subsection{Propietats dels valors i vectors propis}

\begin{frame}
\frametitle{Propietats dels valors i vectors propis}
\begin{block}{Propietats}
\begin{itemize}
\item La suma dels $n$ valors propis d'una matriu és igual a la seva traça.
\item Els valors propis d'una matriu i de la seva transposada coincideixen.
\item El producte dels $n$ valors propis d'una matriu és igual al seu determinant.
\end{itemize}
\end{block}
\end{frame}

\begin{frame}
\frametitle{Propietats dels valors i vectors propis}
\begin{block}{Propietats}
\begin{itemize}
\item Dues matrius semblants tenen la mateixa equació característica, i por tant els mateixos valors propis amb el mateix grau de multiplicitat.
\item Una matriu triangular té com a valors propis els elements de la diagonal principal. 
\item A valors propis diferents, els hi correspon vectors propis linealment independents.
\item Un mateix vector propi no pot estar associat a dos valors propis diferents. 
\end{itemize}
\end{block}
\end{frame}



\begin{frame}
\frametitle{Propietats dels valors i vectors propis}
\begin{block}{Teorema}
La dimensió del subespai propi $H_i$ associat al valor propi $\lambda_i$ és major o igual que 1 i menor o igual que l'ordre de multiplicitat (o multiplicitat algebraica), $n_i$ del valor propi
\[1\leq dim(H_i)\leq n_i\]
\end{block}

\begin{block}{Corol·lari}
Si la multiplicitat algebraica del valor propi és 1 ($n_i=1$), la dimensió del corresponent subespai propi (multiplicitat geomètrica) serà també 1
\[1\leq dim(H_i)\leq n_i = 1 \Rightarrow dim(H_i) = 1\]
\end{block}
\end{frame}

\begin{frame}
\frametitle{Propietats dels valors i vectors propis}
\begin{block}{Teorema}
Donats $\lambda_1, \lambda_2, \cdots, \lambda_r$, valors propis diferents de la matriu $A\in M_{n\times n}(\mathbb R)$ i $\vec u_1, \vec u_2, \cdots, \vec u_r$ els vectors propis associats a ells, llavors $\vec u_1, \vec u_2, \cdots, \vec u_r$ son linalment independents. 
\end{block}

\begin{block}{Teorema}
Si la matriu $A\in M_{n\times n}(\mathbb R) $ formada per vectors d'un espai vectorial $E$ té $n$ valors propis, també tendrà $n$ vectors propis que seran linealment independents: $\vec u_1, \vec u_2, \cdots, \vec u_n$. 

A més, com que $n$ vectors LI d'un espai de dimensió finita $n$ són base, $\vec u_1, \vec u_2, \cdots, \vec u_n$ seran una base de $E$.
\end{block}
\end{frame}


\section{Matrius diagonalitzables}
\section{Definició}

\begin{frame}
\frametitle{Matrius diagonalitzables}
Recordem que hem començat el tema dient que una matriu $A$ és diagonalitzable si existeix una matriu $D$ diagonal semblant a ella. $A$ i $D$ són semblants si es pot establir una igualtat entre elles $D=Q^{-1}\cdot A \cdot Q$, on $Q$ es una matriu regular. 

\begin{block}{Teorema}
Una matriu $A\in M_{n\times n}$ és diagonalitzable si i només si té $n$ vectors propis linealment independents. 

Equivalentment, la condició necessària i suficient perque una matriu sigui diagonalitzable és que existeixi una base de l'espai vectorial formada per vectors propis de la matriu donada. 
\end{block}
\end{frame}

\begin{frame}
\frametitle{Matrius diagonalitzables}
\begin{block}{Corol·lari}
Si la matriu $A$ té $n$ valors propis diferents. hi haurà $n$ vectors propis LI, i com a conseqüència $A$ serà diagonalitzable.
\end{block}

\begin{block}{Exercici 6}
Estudiar els valors propis de la matriu $B$
\[B=\left(\begin{array}{ccc}2 & 0 & 2 \\0 & -1 & 0 \\2 & 0 & -1\end{array}\right)\]
És $B$ diagonalitzable?
\end{block}
\end{frame}

\begin{frame}
\frametitle{Matrius diagonalitzables}

\[B- \lambda I=\left(\begin{array}{ccc}2- \lambda & 0 & 2 \\0 & -1- \lambda & 0 \\2 & 0 & -1- \lambda\end{array}\right)\]
El polinomi característic és
\[-(1+\lambda)(\lambda-3)(\lambda+2)\]
Per tant els valors propis són $\lambda_1 = -1, \lambda_2 = 3, \lambda_3 = -2$. Com que esteim en un espai vectorial de dimensió 3 i hi ha 3 valors propis reals i diferents, la matriu és diagonalitzable. 
\end{frame}

\begin{frame}
\frametitle{Matrius diagonalitzables}
Arribats a aquest punt, esteim en condicions d'enunciar el teorema que ens permet saber qué ha de passar perque una matriu sigui diagonalitzable:
\begin{block}{Teorema}
La condició necessària i suficient perque una matriu $A$ sigui diagonalitzable és que per cada valor propi $\lambda_i$ el seu ordre de multiplicitat $n_i$ coincideixi amb la seva multiplicitat geomètrica $dim(H_i)$
\[dim(H_i) = n_i\ \forall \ \lambda_i\]

\end{block}
\end{frame}


\begin{frame}
\frametitle{Matrius diagonalitzables}

D'aquesta manera, si la matriu té $r$ valors propis diferents $\lambda_1, \lambda_2\cdots, \lambda_r$ unint bases de tots els subespais propis $H_1,H_2,\cdots, H_n$ obtindrem una base de $E$
\[\{B_{H_1}\cup B_{H_2} \cup \cdots \cup B_{H_r}\} = B_E\]
\end{frame}


\begin{frame}
\frametitle{Matrius diagonalitzables}
En resum, $A$ és diagonalitzable si tots els valors propis pertanyen als nombres reals i
\begin{itemize}
\item Son tots ells diferents, o bé
\item Són múltiples i les multiplicitats algebraiques i geomètriques són iguals. 
\end{itemize}

A més, la matriu $D$ té com elements de la diagonal principal els valors propis de la matriu $A$ i compleix la igualtat \[D = (VP)^{-1}\cdot A \cdot (VP)\] on la matriu $VP$ és la matriu que té per columnes els $n$ vectors propis LI de la matriu $A$.
\end{frame}


\subsection{Càlcul de la matriu diagonal}
\begin{frame}
\frametitle{Càlcul de la matriu diagonal}
\begin{block}{Procediment per diagonalitzar una matriu $A$}
\begin{enumerate}
\item Trobar el polinomi característic
\item Obtenir les arrels de l'equació característica, és a dir els valors propis $\lambda_i$ i els seus ordres de multiplicitat $n_i$.
\item Resoldre per cada $\lambda_i$ el sistema $(A-\lambda_i I) \vec x = \vec 0$ per trobar els vectors propis i els subespais propis.
\item Si $n_i = dim(H_i)$ per cada valor propi $\lambda_i$, aleshores la matriu és diagonalitzable.
\item La matriu $D$ té com elements de la diagonal principal els valors propis de la matriu $A$ i   $D = (VP)^{-1}\cdot A \cdot (VP)$ on la matriu $VP$ és la matriu que té per columnes els $n$ vectors propis LI de la matriu $A$ col·locats seguint el mateix ordre que els valors propis en la matriu $D$.
\end{enumerate}

\end{block}
\end{frame}


\begin{frame}
\frametitle{Càlcul de la matriu diagonal}
\begin{block}{Exercici 7}
Diagonalitzar la matriu \[B=\left(\begin{array}{ccc}2 & 0 & 2 \\0 & -1 & 0 \\2 & 0 & -1\end{array}\right)\]
\end{block}
\end{frame}

\begin{frame}
\frametitle{Càlcul de la matriu diagonal}
D'un exemple anterior, sabem que els valors propis són $\lambda_1 = -1, \lambda_2 = 3, \lambda_3 = -2$ i els subespais propis
\[H_1 = \langle (0,1,0)\rangle, H_2 = \langle (2,0,1)\rangle, H_3 = \langle (1,0,-2)\rangle\]
Per tant 
\[D=\left(\begin{array}{ccc}-1 & 0 & 0 \\0 & 3 & 0 \\0 & 0 & -2\end{array}\right), VP=\left(\begin{array}{ccc}0 & 2 & 1 \\1 & 0 & 0 \\0 & 1 & -2\end{array}\right)\]
\begin{block}{Exercici 8}
Calculau $(VP)^{-1}$ i demostrau que $D=(VP)^{-1}\cdot A\cdot (VP)$
\end{block}
\end{frame}

\begin{frame}
\frametitle{Càlcul de la matriu diagonal}
La solució és
\[VP^{-1}=\frac{1}{5}\left(\begin{array}{ccc}0 & 5 & 0 \\2 & 0 & 1 \\1 & 0 & -2\end{array}\right)\]
i si es fa el producte $(VP)^{-1}\cdot A\cdot (VP)$ es comprova fàcilment que la solució és $D$. 
\end{frame}


\begin{frame}
\frametitle{Càlcul de la matriu diagonal}
\begin{block}{Exercici 9 }
Diagonalitzar la matriu \[C=\left(\begin{array}{ccc}-1 & 3 & 0 \\3 & -1 & 0 \\0 & 0 & 2\end{array}\right)\]
\end{block}
\end{frame}



\begin{frame}
\frametitle{Càlcul de la matriu diagonal}
El polinomi característic és
\[(2-\lambda)(\lambda-2)(\lambda+4)\]
i per tant els valors propis són $\lambda_1 = -4$ amb multiplicitat $n_1=1$ i $\lambda_2 = 2$ amb $n_2 = 2$. Els espais propis són
\[H_1 = \langle (1,-1,0)\rangle, H_2 = \langle (1,1,0), (0,0,1)\rangle\]
Per tant, $dim(H_i) = n_i$ per tots dos i  
\[D=\left(\begin{array}{ccc}-4 & 0 & 0 \\0 & 2 & 0 \\0 & 0 & 2\end{array}\right), VP=\left(\begin{array}{ccc}1 & 1 & 0\\-1 & 1 & 0 \\0 & 0 & -1\end{array}\right)\]
\begin{block}{Exercici 10}
Calculau $(VP)^{-1}$ i demostrau que $D=(VP)^{-1}\cdot A\cdot (VP)$
\end{block}
\end{frame}


\begin{frame}
\frametitle{Càlcul de la matriu diagonal}
La solució és
\[VP^{-1}=\frac{1}{2}\left(\begin{array}{ccc}1 & -1 & 0 \\1 & 1 & 0 \\0 & 0 & 2\end{array}\right)\]
i si es fa el producte $(VP)^{-1}\cdot A\cdot (VP)$ es comprova fàcilment que la solució és $D$. 
\end{frame}


\begin{frame}
\frametitle{Càlcul de la matriu diagonal}
\begin{block}{Exercici 11}
Diagonalitzar la matriu \[A=\left(\begin{array}{ccc}6 & 0 & 0 \\2 & 6 & 0 \\2 & 2 & 8\end{array}\right)\]
\end{block}
\end{frame}




\begin{frame}
\frametitle{Càlcul de la matriu diagonal}
El polinomi característic és
\[(8-\lambda)(6-\lambda)^2\]
i per tant els valors propis són $\lambda_1 = 6$ amb multiplicitat $n_1=2$ i $\lambda_2 = 8$ amb $n_2 = 1$. 

Si ho calculam, el subespai propi $H_1$ ve generat pel vector $(0,-1,1)$ i per tant
\[1=dim(H_1) < 2 = n_1\]
Per tant, els valors són diferents i concloem que la matriu $A$ no és diagonalitzable. 
\end{frame}


\section{Diagonalització ortogonal}




\begin{frame}
\frametitle{Diagonalització ortogonal}
Les matrius reals simètriques són sempre diagonalitzables és a dir, tenen una base de vectors propis. I no només això, si no que sempre tenen una base de vectors propis ortonormals (és a dir, els seus vectors són ortogonals dos a dos i unitaris). 

\end{frame}

\begin{frame}
\frametitle{Diagonalització ortogonal}
\begin{block}{Matriu ortogonal}
Una matriu quadrada $Q$ es diu \textbf{ortogonal} si es compleix que la seva inversa i la seva transposta són iguals
\[Q^t = Q^{-1}\]
\end{block}
\end{frame}

\begin{frame}
\frametitle{Diagonalització ortogonal}
\begin{block}{Matriu ortogonalment diagonalitzable}
Es diu que una matriu quadrada $A$ és \textbf{ortogonalment diagonalitzable} si existeix una base de vectors propis ortonormals. Això és equivalent a dir que existeix una matriu $Q$ ortogonal tal que \[Q^t\cdot A\cdot Q\] és una matriu diagonal formada pels valors propis de $A$
\end{block}
\end{frame}


\begin{frame}
\frametitle{Diagonalització ortogonal}
\begin{block}{Teorema}
Si $A$ és una matriiu quadrada real simètrica de tamany $n$, aleshores es verifica
\begin{enumerate}
\item Tots els valors propis de la matriu són reals.
\item Els vectors propis associats a valors propis diferents són ortogonals
\item Té $n$ vectors propis, és a dir diagonalitza. 
\item Té $n$ vectors propis ortonormals, és a dir, és ortogonalment diagonalitzable.
\end{enumerate}
\end{block}
\end{frame}




\begin{frame}
\frametitle{Diagonalització ortogonal}
\begin{block}{Exercici 12}
Diagonalitzar ortogonalment la matriu \[B=\left(\begin{array}{ccc}2 & 0 & 2 \\0 & -1 & 0 \\2 & 0 & -1\end{array}\right)\]
\end{block}
\end{frame}



\begin{frame}
\frametitle{Diagonalització ortogonal}
En un exercici precedent, hem vist que els valors propis d'aquesta amtriu eren $\lambda_1 = -1, \lambda_2 = 3, \lambda_3 = -2$ i que els subespais propis venien generats per
\[B_{H_1} = \{\vec u_1\} = \{(0,1,0)\}\]
\[B_{H_2} = \{\vec u_2\} = \{(2,0,1)\}\]
\[B_{H_3} = \{\vec u_3\} = \{(1,0,-2)\}\]
Unint les tres bases tenim una base de l'espai vectorial total
\[B=\{\vec u_1, \vec u_2, \vec u_3\}\] 
\end{frame}


\begin{frame}
\frametitle{Diagonalització ortogonal}
Si feim els productes escalars pertinents, resulta que
\[\vec u_1 \cdot \vec u_2 = (0,1,0)\cdot (2,0,1) = 0\]
\[\vec u_1 \cdot \vec u_3 = (0,1,0)\cdot (1,0,-2) = 0\]
\[\vec u_2 \cdot \vec u_3 = (2,0,1)\cdot (1,0,-2) = 0\]
$B$ és una base ortogonal. Perque sigui ortogonalment diagonalitzable, només ens cal que siguin unitaris. 
\[||\vec u_1|| = 1, ||\vec u_2|| = \sqrt{5}, ||\vec u_3|| = \sqrt{5}\]
\end{frame}

\begin{frame}
\frametitle{Diagonalització ortogonal}
Per tant, una base ortonormal és
\[B=\left\{(0,1,0), \left(\frac{2}{\sqrt 5}, 0 \frac{1}{\sqrt 5}\right), \left(\frac{1}{\sqrt 5}, 0, \frac{-2}{\sqrt 5}\right)\right\}\]

Per tant, la matriu ortogonal de vectors propis és 
\[(VP)_{ort} = \left(\begin{array}{ccc} 0 & \frac{2}{\sqrt 5} & \frac{1}{\sqrt 5} \\1 & 0 & 0 \\0 & \frac{1}{\sqrt 5} & \frac{-2}{\sqrt 5}\end{array}\right) \]

\end{frame}


\begin{frame}
\frametitle{Diagonalització ortogonal}
Finalment, podem comprovar que $(VP)_{ort}^t\cdot B \cdot (VP)_{ort} = D$
\[ \left(\begin{array}{ccc} 0 & 1& 0 \\\frac{2}{\sqrt 5}  & 0 & \frac{1}{\sqrt 5}  \\ \frac{1}{\sqrt 5} & 0 & \frac{-2}{\sqrt 5}\end{array}\right)    \left(\begin{array}{ccc} 2 & 0& 2 \\ 0  & -1 & 0  \\2 & 0 & -1 \end{array}\right)        \left(\begin{array}{ccc} 0 & \frac{2}{\sqrt 5} & \frac{1}{\sqrt 5} \\1 & 0 & 0 \\0 & \frac{1}{\sqrt 5} & \frac{-2}{\sqrt 5}\end{array}\right) =\]
\[ \left(\begin{array}{ccc}-1 & 0& 0 \\ 0  & 3 & 0  \\ 0 & 0 & -2\end{array}\right)   \]
\end{frame}



\begin{frame}
\frametitle{Diagonalització ortogonal}
\begin{block}{Exercici 13}
Diagonalitzar ortogonalment la matriu \[A=\left(\begin{array}{ccc}4 & 1 & 1 \\1 & 4 & 1 \\1 & 1 & 4\end{array}\right)\]
\end{block}
\end{frame}




\begin{frame}
\frametitle{Diagonalització ortogonal}
En un exercici precedent, hem vist que els valors propis d'aquesta amtriu eren $\lambda_1 = 3$ amb multiplicitat algebraica $n_1=2$, $\lambda_2 = 6$ amb $n_2=1$

\[B_{H_1} =  \{(-1,1,0), (-1,0,1)\}\]
\[B_{H_2} = \{(1,1,1)\}\]

Unint les dues bases tenim una base de l'espai vectorial total
\[B=\{\vec u_1, \vec u_2, \vec u_3\} = \{(-1,1,0),(-1,0,1),(1,1,1)\}\] 
\end{frame}




\begin{frame}
\frametitle{Diagonalització ortogonal}
Si feim els productes escalars pertinents, resulta que
\[\vec u_1 \cdot \vec u_2 = (-1,1,0)\cdot (-1,0,1) = 1\neq 0\]
\[\vec u_1 \cdot \vec u_3 = (-1,1,0)\cdot (1,1,1) = 0\]
\[\vec u_2 \cdot \vec u_3 = (-1,0,1)\cdot (1,1,1) = 0\]
$B$ NO és una base ortogonal. Haurem de començar per ortogonalitzarla amb el teorema de Gram-Smidth. 

\end{frame}



\begin{frame}
\frametitle{Diagonalització ortogonal}
\[\vec c_1 = \vec u_1 = (-1,1,0)\]
\[\vec c_2 = \vec u_2  - \frac{\vec c_1\cdot \vec u_2}{\vec c_1\cdot \vec c_1} \vec c_1 = \]
\[= (-1,0,1)- \frac{(-1,1,0)\cdot (-1,0,1)}{(-1,1,0)\cdot(-1,1,0)}(-1,1,0) = \left(-\frac{1}{2},-\frac{1}{2},1 \right)\]
Com que $\vec u_3$ ja era ortogonal a $\vec u_1$ i $\vec u_2$, per construcció també ho és ja a $\vec c_1, \vec c_2$.
\[B_{ort} = \left\{(-1,1,0), \left( \frac{-1}{2}, \frac{-1}{2},1 \right), (1,1,1) \right\} \]
\end{frame}



\begin{frame}
\frametitle{Diagonalització ortogonal}ulam la norma de cadascun dels vectors i els dividim per aquest valor per obtenir vectors unitaris
\[B_{ort-uni} = \left\{(\frac{-1}{\sqrt 2},\frac{1}{\sqrt 2},0), \left( \frac{-1}{\sqrt 6},\frac{-1}{\sqrt 6},\frac{2}{\sqrt 6} \right), (\frac{1}{\sqrt 3},\frac{1}{\sqrt 3},\frac{1}{\sqrt 3}) \right\} \]



La matriu ortonormal de vectors propis és doncs:
\[A=\left(\begin{array}{ccc}\frac{-1}{\sqrt 2} & \frac{-1}{\sqrt 6} & \frac{1}{\sqrt 3} \\\frac{1}{\sqrt 2} & \frac{-1}{\sqrt 6} & \frac{1}{\sqrt 3} \\0 & \frac{2}{\sqrt 6} & \frac{1}{\sqrt 3}\end{array}\right)\]
Finalment, recordau que podeu provar que $(VP)_{ort}^t\cdot A \cdot (VP)_{ort}$ per veure que no us heu equivocat. 


\end{frame}


%  \begin{figure}[h]
  %  \label{fig:volum}
%\centering
%\includegraphics[height=3cm]{volum}
%\end{figure}


\end{document}